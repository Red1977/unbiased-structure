
{% load static %}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>Babylon Template</title>
        <style>
            #renderCanvas {
                width: 500px;
                height: 500px;
                touch-action: none;
            }

            th, td {
                padding: 15px;
            }
        </style>

        <script src="https://cdn.babylonjs.com/babylon.js"></script> <!--TODO: REPLACE WITH PROPER CDN -->
        <script src="https://cdn.babylonjs.com/gui/babylon.gui.js"></script>
        <script src="https://cdn.babylonjs.com/nodeEditor/babylon.nodeEditor.js"></script>
        <script src="https://cdn.babylonjs.com/nodeGeometryEditor/babylon.nodeGeometryEditor.js"></script>
        <script src="https://cdn.babylonjs.com/guiEditor/babylon.guiEditor.js"></script>
        <script src="https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
        <script src="https://cdn.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
        <script src="https://cdn.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
        <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
        <script src="https://cdn.babylonjs.com/serializers/babylonjs.serializers.min.js"></script>
        <script src="https://cdn.babylonjs.com/accessibility/babylon.accessibility.js"></script>


    </head>

   <body>
    <h1>{{product.product_name}}</h1>

    <table >
        <tr>
            <td>
                <canvas id="renderCanvas"></canvas>
                
            </td>
            <td valign="top">
                <!-- Controls -->
                <div>
                    <div>
                        <br>
                        <button type="button" class="btn btn-dark" id="sayhello_button">Activate Label</button>
                    </div>
                </div>

                <br>
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button type="submit">Upload</button>
                    <input type="hidden" id="texture_input"></input>
                </form>
                

                <!-- debug 
                <p>This is some text</p>
                
                <p>.glb filename: {{ product.glb_filename }}</p>
                <p>Path to blender scene: {{ product.blender_scene_path }}</p>2
                <p>Size in ml: {{ product.size_ml }}</p>
                <img id= "uploaded_image" src="{{ file_url }}">
                <p>Thumbnail path: {{ product.thumbnail_path }}</p>-->
            </td>
        </tr>
    </table>

    <script type="text/javascript"  src="{% static 'js/babylon_preview.js' %}"
                                    defer
                                    data-path_to_glb="{{ product.glb_filename }}"
                                    data-background_image="{{ product.background_image }}"
                                    >
    </script>

    {% if file_url %}
    <p>File uploaded to: <a href="{{ file_url }}">{{ file_url }}</a></p>

    <script type="text/javascript">
    { 
            document.getElementById("texture_input").value = "{{ file_url }}";
            document.getElementById("texture_input").dispatchEvent(new Event("change"));
        };
    </script>

    {% endif %}
   </body>

</html>